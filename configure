#!/usr/bin/env bash 

source ~/.profile

# get directory where this file is in and set as directory
JMB="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
cd $JMB

echo "i config starting"
echo "i jmb is here: $JMB"

export HERE=$JMB/bin

if [[ ${JMB} == '' ]]
then
    echo "i exporting JMB"
    echo "export JMB=$HERE" >> ~/.profile
    export JMB=$HERE
fi

if [[ $(echo "$PATH" | grep "$JMB" -F) == '' ]]
then
    echo "i updating PATH"
    echo "export PATH="$JMB${PATH:+:${PATH}}"" >> ~/.profile
    export PATH="$JMB${PATH:+:${PATH}}"
fi

echo "i making bin/ executable"
chmod +x bin/*

echo "i running dos2unix"
dos2unix bin/dos2unix-dir
./bin/dos2unix-dir bin

echo "i installing pak and scribe"
Rscript --vanilla -e "if (!requireNamespace('scribe')) utils::install.packages('scribe')"
./bin/pak-install source

echo "i done"
echo "i best to restart console"
