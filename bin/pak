#!/usr/bin/env -S Rscript --vanilla 


# pak for pak
options(
  repos =  c(CRAN = "https://cloud.r-project.org"),
  pak.no_extra_messages = TRUE
)

ca <- scribe::command_args()
ca$add_description("pak : R package installation")
ca$add_description("console wrapper for calling pak::pak() from R.")
ca$add_example("pak fuj", "install {fuj} from CRAN")
ca$add_example("pak --d true -u github::tidyverse/dplyr github::tidyverse/tidyr", "install dev packages")
ca$add_argument(
  "...",
  "pkg",
  default = "local::.",
  help = "packages to install (default: local::.)"
)
ca$add_argument(
  "-d",
  "--dep",
  "--dependencies",
  default = NA,
  help = "dependencies (coerced)"
)
ca$add_argument(
  "-u",
  "--upgrade",
  action = "flag",
  default = FALSE,
  help = "upgrade (sets to TRUE)"
)
args <- ca$parse()

writeLines(paste(c("pak::", format(do.call(call, c("pak", args)))), collapse = ""))
do.call(pak::pak, args)
